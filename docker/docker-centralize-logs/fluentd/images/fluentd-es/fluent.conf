<source>
  @type forward
</source>

#NGINX
# <match unparse.nginx.docker.**>
#   type parser
#   format nginx
#   remove_prefix unparse
#   key_name log
#   reserve_data yes
# </match>
#
# <match nginx.docker.**>
#   type elasticsearch
#   host "#{ENV['ES_HOST']}"
#   port "#{ENV['ES_PORT']}"
#   type_name "#{ENV['ES_TYPE']}"
#   logstash_prefix "#{ENV['ES_INDEX']}"
#   logstash_format true
# </match>

<filter docker.**>
  @type concat
  key log
  stream_identity_key container_id
  multiline_start_regexp /^\S+/
  flush_interval 5s
</filter>

<match docker.**>
  type elasticsearch
  host "#{ENV['ES_HOST']}"
  port "#{ENV['ES_PORT']}"
  type_name "#{ENV['ES_TYPE']}"
  logstash_prefix "#{ENV['ES_INDEX']}"
  logstash_format true
</match>
