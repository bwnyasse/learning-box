<source>
  @type forward
</source>

@include wildfly.conf

<filter docker.**>
  type concat
  key log
  stream_identity_key container_id
  multiline_start_regexp /^\S+/
  flush_interval 60s
  timeout_label @PROCESSDATATIMEOUT
</filter>

<label @PROCESSDATATIMEOUT>
  <match docker.**>
    type better_timestamp
    tag elasticsearch
  </match>
</label>

####### Add better timestamp
<match docker.**>
  type better_timestamp
  tag elasticsearch
</match>

###### Flush to ES
<match elasticsearch>
  type elasticsearch
  hosts http://elasticsearch:9200
  type_name "#{ENV['ES_TYPE']}"
  logstash_prefix "#{ENV['ES_INDEX']}"
  logstash_format true
  flush_interval 60s
</match>

<match **>
  type elasticsearch
  hosts http://elasticsearch:9200
  type_name "#{ENV['ES_TYPE']}"
  logstash_prefix "not_process"
  logstash_format true
  flush_interval 60s
</match>
